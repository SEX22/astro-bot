<!DOCTYPE html>
<html lang="ru">
<head>
    <script>
        // СТРОКА 5: СЮДА ВСТАВЛЯЕШЬ СВОЙ КЛЮЧ AIzaSy...
        const apiKey = "AIzaSyCQ6qi-gIdEUeg34PNiJ_ogZeY9952di0Q"; 
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Астро Поток 2026</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&display=swap');
        body { font-family: 'Montserrat', sans-serif; background: #0f172a; color: #f1f5f9; margin: 0; padding: 0; overflow-x: hidden; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); border-radius: 24px; }
        .zodiac-btn { transition: all 0.2s; background: rgba(255,255,255,0.03); border-radius: 16px; border: 1px solid rgba(255,255,255,0.05); cursor: pointer; text-align: center; }
        .zodiac-btn.active { background: rgba(99, 102, 241, 0.3); border-color: #6366f1; transform: scale(1.05); }
        .loading-spinner { width: 24px; height: 24px; border: 3px solid rgba(255,255,255,0.1); border-top-color: #6366f1; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body class="p-4 flex flex-col items-center min-h-screen justify-center">
    <div class="max-w-md w-full glass p-6 shadow-2xl relative">
        <header class="text-center mb-6">
            <h1 class="text-2xl font-bold tracking-tight text-white">Астро Поток</h1>
            <p id="userName" class="text-[10px] text-indigo-400 uppercase tracking-[0.2em] mt-1">Загрузка...</p>
        </header>

        <div id="zodiacGrid" class="grid grid-cols-4 gap-3 mb-8"></div>

        <button onclick="generate()" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-4 rounded-2xl shadow-lg active:scale-95 transition-all text-xs uppercase tracking-widest">Спросить Вселенную</button>

        <div id="resBox" class="mt-8 p-5 rounded-2xl bg-white/5 border border-white/10 hidden">
            <div id="loader" class="flex flex-col items-center py-4">
                <div class="loading-spinner"></div>
            </div>
            <div id="resText" class="text-sm leading-relaxed text-gray-200"></div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        let selectedSign = null;
        const signs = [
            {n:"Овен", i:"♈"}, {n:"Телец", i:"♉"}, {n:"Близнецы", i:"♊"}, {n:"Рак", i:"♋"},
            {n:"Лев", i:"♌"}, {n:"Дева", i:"♍"}, {n:"Весы", i:"♎"}, {n:"Скорпион", i:"♏"},
            {n:"Стрелец", i:"♐"}, {n:"Козерог", i:"♑"}, {n:"Водолей", i:"♒"}, {n:"Рыбы", i:"♓"}
        ];

        function init() {
            tg.expand();
            tg.ready();
            const user = tg.initDataUnsafe?.user;
            document.getElementById('userName').innerText = `Привет, ${user?.first_name || 'путник'}`;
            
            const grid = document.getElementById('zodiacGrid');
            signs.forEach(s => {
                const b = document.createElement('div');
                b.className = 'zodiac-btn p-3 flex flex-col items-center';
                b.innerHTML = `<span class="text-2xl">${s.i}</span><span class="text-[8px] mt-1 uppercase text-gray-500">${s.n}</span>`;
                b.onclick = () => {
                    selectedSign = s.n;
                    document.querySelectorAll('.zodiac-btn').forEach(el => el.classList.remove('active'));
                    b.classList.add('active');
                    if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
                };
                grid.appendChild(b);
            });
        }

        async function generate() {
            if (!selectedSign) return;
            const box = document.getElementById('resBox'), loader = document.getElementById('loader'), txt = document.getElementById('resText');
            box.classList.remove('hidden'); loader.classList.remove('hidden'); txt.innerHTML = '';

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: `Напиши короткий мистический гороскоп на сегодня для знака ${selectedSign}. Будь краток и вдохновляй.` }] }] })
                });
                const data = await response.json();
                const result = data.candidates[0].content.parts[0].text;
                txt.innerHTML = result.replace(/\n/g, '<br>');
            } catch (e) {
                txt.innerHTML = "<span class='text-red-400'>Ошибка связи с космосом. Проверь лимиты или ключ.</span>";
            }
            loader.classList.add('hidden');
        }

        init();
    </script>
</body>
</html>
